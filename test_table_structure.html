<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Test - Estructura de Tabla de Compras</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/css/bootstrap.min.css" rel="stylesheet">
</head>
<body>
    <div class="container mt-5">
        <h2>Test - Estructura de Tabla de Compras</h2>

        <div class="alert alert-info">
            <strong>Instrucciones:</strong> Selecciona productos y registra el <strong>costo de compra</strong> (no el precio de venta).
            El sistema calculará automáticamente tu utilidad comparando con el precio de venta registrado en el catálogo.
        </div>

        <div class="table-responsive">
            <table class="table table-bordered" id="productsTable">
                <thead>
                    <tr>
                        <th>Producto</th>
                        <th>Cantidad</th>
                        <th>Costo Unitario</th>
                        <th>Subtotal</th>
                        <th>Fecha Caducidad</th>
                        <th>Lote</th>
                        <th>Acciones</th>
                    </tr>
                </thead>
                <tbody id="productsTableBody">
                    <!-- Test row -->
                    <tr id="productRow_0">
                        <td>
                            <input type="text" class="form-control product-name" readonly
                                   value="CONCEI"
                                   onclick="alert('Seleccionar producto')">
                            <input type="hidden" class="product-id" value="1">
                        </td>
                        <td>
                            <input type="number" class="form-control quantity" min="1" value="1"
                                   placeholder="Cantidad">
                        </td>
                        <td>
                            <input type="number" class="form-control unit-price" min="0" step="0.0001" value="1.0000"
                                   placeholder="Costo de compra">
                        </td>
                        <td><span class="subtotal">$1.0000</span></td>
                        <td>
                            <input type="date" class="form-control expiration-date" value="2025-12-31">
                        </td>
                        <td>
                            <input type="text" class="form-control batch-number" placeholder="Lote (opcional)">
                        </td>
                        <td>
                            <button type="button" class="btn btn-sm btn-danger">
                                <i class="ti ti-trash"></i>
                            </button>
                        </td>
                    </tr>
                </tbody>
            </table>
        </div>

        <button type="button" class="btn btn-primary btn-sm">
            <i class="ti ti-plus"></i> Agregar Producto
        </button>

        <hr>

        <h3>Verificación de Estructura</h3>
        <div class="row">
            <div class="col-md-6">
                <h5>Encabezados de la Tabla:</h5>
                <ol id="headersList">
                    <!-- Se llenará con JavaScript -->
                </ol>
            </div>
            <div class="col-md-6">
                <h5>Campos de la Fila de Prueba:</h5>
                <ol id="fieldsList">
                    <!-- Se llenará con JavaScript -->
                </ol>
            </div>
        </div>
    </div>

    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/js/bootstrap.bundle.min.js"></script>
    <script>
        // Verificar estructura de la tabla
        document.addEventListener('DOMContentLoaded', function() {
            const headers = document.querySelectorAll('#productsTable thead th');
            const fields = document.querySelectorAll('#productRow_0 td');

            const headersList = document.getElementById('headersList');
            const fieldsList = document.getElementById('fieldsList');

            // Listar encabezados
            headers.forEach((header, index) => {
                const li = document.createElement('li');
                li.textContent = `${index + 1}. ${header.textContent.trim()}`;
                headersList.appendChild(li);
            });

            // Listar campos
            fields.forEach((field, index) => {
                const li = document.createElement('li');
                const input = field.querySelector('input, span');
                const type = input ? input.tagName : 'button';
                const value = input ? (input.value || input.textContent || input.placeholder || 'N/A') : 'button';
                li.textContent = `${index + 1}. ${type} - ${value}`;
                fieldsList.appendChild(li);
            });

            console.log('Número de columnas:', headers.length);
            console.log('Número de campos:', fields.length);

            if (headers.length === fields.length) {
                console.log('✅ La tabla está correctamente estructurada');
            } else {
                console.log('❌ Hay un desfase en la estructura de la tabla');
            }
        });
    </script>
</body>
</html>
